{
  "type": "workflow_collections",
  "data": [
    {
      "@context": "/api/3/contexts/WorkflowCollection",
      "@type": "WorkflowCollection",
      "name": "Sample - IBM Security QRadar EDR - 1.0.0",
      "description": "Sample playbooks for \"IBM Security QRadar EDR\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/4276f509-57ea-4e53-9b83-e3d0cb4b4981",
      "id": 76,
      "createDate": 1691480135.618764,
      "modifyDate": 1691480135.618764,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [
        "IBM",
        "ibm-security-qradar-edr"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Events Related To Alerts",
          "aliasName": null,
          "tag": "#IBM Security QRadar EDR",
          "description": "This action is used to retrieve all events related to alerts generated in QRadar EDR",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/e8910062-8a5b-4937-a13f-479ed49cf72a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d38debee-0c91-463f-8a5d-58221fc28238",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Events Related To Alerts",
              "description": null,
              "arguments": {
                "name": "IBM Security QRadar EDR",
                "config": "''",
                "params": {
                  "get_all_records": true
                },
                "version": "1.0.0",
                "connector": "ibm-security-qradar-edr",
                "operation": "get_events_related_to_alerts",
                "operationTitle": "Get Events Related To Alerts",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "a98513ac-de76-414b-87bc-5e3f79bbfb7e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "1399f9c4-d1ce-46ff-bf74-6075fa642853",
                "title": "IBM Security QRadar EDR: Get Events Related To Alerts",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d38debee-0c91-463f-8a5d-58221fc28238"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Events Related To Alerts",
              "targetStep": "/api/3/workflow_steps/a98513ac-de76-414b-87bc-5e3f79bbfb7e",
              "sourceStep": "/api/3/workflow_steps/d38debee-0c91-463f-8a5d-58221fc28238",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9345a722-8994-4546-bd44-8af0804127b6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "03a4d0c0-dff0-48f0-9756-d3eb755c7d5c",
          "id": 875,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "ibm-security-qradar-edr",
            "IBM"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "IBM Security QRadar EDR > Ingest",
          "aliasName": null,
          "tag": "#crowd-strike-falcon #ingest #dataingestion",
          "description": "This playbook ingest alerts from IBM Security QRadar EDR and create/update the macro.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691476379,
          "collection": "/api/3/workflow_collections/e8910062-8a5b-4937-a13f-479ed49cf72a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/133a249e-247c-41a5-9304-f3323c4bcc09",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Alerts",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/3a8e5245-a24d-44dd-a953-9a6c419e0491"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "f4b97def-f6a0-48ef-bc33-76bef0668029"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "133a249e-247c-41a5-9304-f3323c4bcc09"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Alert Fetch Macro",
              "description": null,
              "arguments": {
                "config": "''",
                "params": {
                  "macro": "{{vars.steps.Fetch_Alerts.macro_name}}",
                  "value": "{{vars.steps.Fetch_Alerts.updated_last_pull_time}}"
                },
                "version": "3.2.4",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "36101520-312c-4131-b2d2-5b0894342f73"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Detections -> Update Last Detection Fetch Macro",
              "targetStep": "/api/3/workflow_steps/36101520-312c-4131-b2d2-5b0894342f73",
              "sourceStep": "/api/3/workflow_steps/f4b97def-f6a0-48ef-bc33-76bef0668029",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "2c8dc7ed-e6ba-45ed-897e-7a6403683d8b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Detections",
              "targetStep": "/api/3/workflow_steps/f4b97def-f6a0-48ef-bc33-76bef0668029",
              "sourceStep": "/api/3/workflow_steps/133a249e-247c-41a5-9304-f3323c4bcc09",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "bb3eaeb2-60ac-4f09-955d-8d11a222e549"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "059cf02b-dd29-452e-9604-826e76be087b",
          "id": 876,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "ibm-security-qradar-edr",
            "IBM"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Close Alert By ID",
          "aliasName": null,
          "tag": "#IBM Security QRadar EDR",
          "description": "This action is used to close an existing alert.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/e8910062-8a5b-4937-a13f-479ed49cf72a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5ef18043-0cc7-4aad-aa36-19d3a7efa663",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Close Alert By ID",
              "description": null,
              "arguments": {
                "name": "IBM Security QRadar EDR",
                "config": "''",
                "params": {
                  "malicious": false
                },
                "version": "1.0.0",
                "connector": "ibm-security-qradar-edr",
                "operation": "close_alert_by_id",
                "operationTitle": "Close Alert By ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "eee4d276-3541-4714-8171-5ab2422f91ac"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "fdbef3a1-ca46-4e6f-ac15-76ae6a1b6f7c",
                "title": "IBM Security QRadar EDR: Close Alert By ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "5ef18043-0cc7-4aad-aa36-19d3a7efa663"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Close Alert By ID",
              "targetStep": "/api/3/workflow_steps/eee4d276-3541-4714-8171-5ab2422f91ac",
              "sourceStep": "/api/3/workflow_steps/5ef18043-0cc7-4aad-aa36-19d3a7efa663",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f030e94b-7061-446f-a2b8-593d44d3d9a8"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "2c338a3b-152b-4559-a032-bf8fd3e16e06",
          "id": 877,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "ibm-security-qradar-edr",
            "IBM"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> IBM Security QRadar EDR > Fetch and Create",
          "aliasName": null,
          "tag": "#crowd-strike-falcon #fetch #dataingestion #create",
          "description": "Fetch alerts from IBM Security QRadar EDR and Creates records in FortiSOAR.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691494978,
          "collection": "/api/3/workflow_collections/e8910062-8a5b-4937-a13f-479ed49cf72a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/05a5cba3-e24e-4ed2-a770-d2251eb443f8",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "status": "",
                "country": "",
                "severity": "",
                "endpointId": "",
                "severity_map": "{\n    'safe': {{ 'Severity' | picklist('Minimal') }},\n    'low': {{ 'Severity' | picklist('Low') }},\n    'medium': {{ 'Severity' | picklist('Medium') }},\n    'high': {{ 'Severity' | picklist('High') }}\n}",
                "activityState": "",
                "pullTimeMacro": "IBMQradarEDRLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}",
                "triggerCondition": "",
                "fetch_alerts_in_last_X_minutes": 30
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "d4f41797-e6be-4a61-9dac-41dcf14de645"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Alert_List.data.result}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "name": "{{vars.item.title}}",
                  "type": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                  "state": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                  "source": "IBM Security QRadar EDR",
                  "status": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                  "severity": "{{vars.item[\"severity\"] | resolveRange(vars.severity_map)}}",
                  "sourceId": "{{vars.item.id}}",
                  "userName": "{{vars.item.triggerEvents.process.user}}",
                  "__replace": "true",
                  "deviceUID": "{{vars.item.endpointId}}",
                  "eventTime": "{{vars.item.happenedAt}}",
                  "sourcedata": "{{vars.item | toJSON }}",
                  "ackSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "computerName": "{{vars.item.endpoint.name}}",
                  "respSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "priorityWeight": 1,
                  "parentProcessPid": "{{vars.item.triggerEvents.process.parentId}}",
                  "escalatedtoincident": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                  "resolvedAutomatedly": false,
                  "alertRemainingAckSLA": 0
                },
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "975",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "eb9896ef-fda0-43d5-8197-f8bb0fa3a4e6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Associated Event",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Create_Record}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "alert_data": "{{vars.item}}",
                  "last_fetch_time": "{{vars.last_pull_time}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/75249f2a-a58c-41c9-99d0-448fdaa61d6b"
              },
              "status": null,
              "top": "1110",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "a2aaf0f7-7598-415f-a135-9578949fdeed"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Alert List",
              "description": null,
              "arguments": {
                "name": "IBM Security QRadar EDR",
                "config": "44c75a91-61fa-411e-926f-fb4666384a6b",
                "params": {
                  "id": "",
                  "gid": "",
                  "tag": "",
                  "count": "",
                  "status": "{{vars.status}}",
                  "country": "{{vars.country}}",
                  "severity": "{{vars.severity}}",
                  "endpointId": "{{vars.endpointId}}",
                  "lastSeenId": "",
                  "closedAfter": "",
                  "closedBefore": "",
                  "activityState": "{{vars.activityState}}",
                  "happenedAfter": "{{vars.last_pull_time}}",
                  "receivedAfter": "",
                  "happenedBefore": "",
                  "receivedBefore": "",
                  "get_all_records": true,
                  "lastChangedAfter": "",
                  "triggerCondition": "{{vars.triggerCondition}}",
                  "lastChangedBefore": ""
                },
                "version": "1.0.0",
                "connector": "ibm-security-qradar-edr",
                "operation": "get_alert_list",
                "operationTitle": "Get Alert List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3367cd30-da32-48cf-8d45-8379e4b34944"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Alert List For Mapping",
              "description": null,
              "arguments": {
                "name": "IBM Security QRadar EDR",
                "config": "44c75a91-61fa-411e-926f-fb4666384a6b",
                "params": {
                  "id": "",
                  "gid": "",
                  "tag": "",
                  "count": 3,
                  "status": "{{vars.status}}",
                  "country": "{{vars.country}}",
                  "severity": "{{vars.severity}}",
                  "endpointId": "{{vars.endpointId}}",
                  "lastSeenId": "",
                  "closedAfter": "",
                  "closedBefore": "",
                  "activityState": "{{vars.activityState}}",
                  "happenedAfter": "{{vars.last_pull_time}}",
                  "receivedAfter": "",
                  "happenedBefore": "",
                  "receivedBefore": "",
                  "get_all_records": false,
                  "lastChangedAfter": "",
                  "triggerCondition": "{{vars.triggerCondition}}",
                  "lastChangedBefore": ""
                },
                "version": "1.0.0",
                "connector": "ibm-security-qradar-edr",
                "operation": "get_alert_list",
                "operationTitle": "Get Alert List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "06d9984d-ce07-4fa0-98da-57e1b7fb079d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.4",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "ced236d0-c791-4490-b31a-5819c44b1c6b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Data Only For Mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/3367cd30-da32-48cf-8d45-8379e4b34944",
                    "step_name": "Get Alert List"
                  },
                  {
                    "option": "Yes,For Mapping",
                    "step_iri": "/api/3/workflow_steps/06d9984d-ce07-4fa0-98da-57e1b7fb079d",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Get Alert List For Mapping"
                  }
                ],
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "ff0e48f2-66fe-40aa-8695-d3bbf2eaa868"
            },
            {
              "@type": "WorkflowStep",
              "name": "Mapping Data",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Get_Alert_List_For_Mapping.data.result}}"
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "6d2e38e4-07cd-410f-aead-3f1c7abc5e2e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Record Current Time",
              "description": null,
              "arguments": {
                "curr_timestamp": "{{arrow.utcnow().format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z"
              },
              "status": null,
              "top": "840",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "c23d650a-94c8-4611-8035-fffbf7e80391"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Result",
              "description": null,
              "arguments": {
                "macro_name": "{{vars.pullTimeMacro}}",
                "updated_last_pull_time": "{{vars.curr_timestamp}}"
              },
              "status": null,
              "top": "1245",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "8d23b2ad-c2b8-4f5d-af6b-ca67af9b0ae2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}{{arrow.utcnow().shift(minutes=-vars.fetch_alerts_in_last_X_minutes).format('YYYY-MM-DDTHH:mm:ss.SSS')+\"Z\"}}{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "d6ed596e-7092-49b4-b5ab-742028cfa300"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Pull Alerts Created in Last X min\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"integer\",\n    \"name\": \"fetch_alerts_in_last_X_minutes\"\n  },\n  {\n    \"name\": \"status\",\n    \"title\": \"Status\",\n    \"type\": \"multiselect\",\n    \"editable\": true,\n    \"visible\": true,\n    \"required\": false,\n    \"options\": [\n      \"Malicious\",\n      \"Benign\",\n      \"None\"\n    ],\n    \"tooltip\": \"Select the status based on which you want to filter alerts\",\n    \"description\": \"Select the status based on which you want to filter alerts\"\n  },\n  {\n    \"name\": \"severity\",\n    \"title\": \"Severity\",\n    \"type\": \"multiselect\",\n    \"editable\": true,\n    \"visible\": true,\n    \"required\": false,\n    \"options\": [\n      \"Safe\",\n      \"Low\",\n      \"Medium\",\n      \"High\"\n    ],\n    \"tooltip\": \"Select the severity based on which you want to filter alerts\",\n    \"description\": \"Select the severity based on which you want to filter alerts\"\n  },\n  {\n    \"name\": \"activityState\",\n    \"title\": \"Activity State\",\n    \"type\": \"select\",\n    \"editable\": true,\n    \"visible\": true,\n    \"required\": false,\n    \"options\": [\n      \"Active\",\n      \"Idle\",\n      \"Inactive\",\n      \"Archived\"\n    ],\n    \"tooltip\": \"Select the activity state based on which you want to filter alerts\",\n    \"description\": \"Select the activity state based on which you want to filter alerts\"\n  },\n  {\n    \"name\": \"triggerCondition\",\n    \"title\": \"Trigger Condition\",\n    \"type\": \"multiselect\",\n    \"editable\": true,\n    \"visible\": true,\n    \"required\": false,\n    \"options\": [\n      \"Code Injection\",\n      \"Process Impersonated\",\n      \"Signature Forged\",\n      \"Incident Correlated\",\n      \"DLL Sideloaded\",\n      \"Suspicious Script Executed\",\n      \"Policies Triggered\",\n      \"Anomalous Behavior Detected\",\n      \"Token Stolen\",\n      \"Ransomware Behavior Detected\",\n      \"Privilege Escalated\",\n      \"External Trigger\",\n      \"Detection Strategy\",\n      \"Antimalware Detection\"\n    ],\n    \"tooltip\": \"Select the trigger condition of the alert\",\n    \"description\": \"Select the trigger condition of the alert\"\n  },\n  {\n    \"name\": \"endpointId\",\n    \"title\": \"Endpoint ID\",\n    \"type\": \"text\",\n    \"editable\": true,\n    \"visible\": true,\n    \"required\": false,\n    \"tooltip\": \"Specify the IDs of the endpoints where the alert was generated, you can specify multiple IDs as comma separated values\",\n    \"description\": \"Specify the IDs of the endpoints where the alert was generated, you can specify multiple IDs as comma separated values\"\n  },\n  {\n    \"name\": \"country\",\n    \"title\": \"Country\",\n    \"type\": \"text\",\n    \"editable\": true,\n    \"visible\": true,\n    \"required\": false,\n    \"tooltip\": \"Filters the alerts that contains connection events to the given countries. Use lowercased alpha-2 country codes, e.g., \\\"it\\\" for Italy. You can specify multiple country as comma separated values\",\n    \"description\": \"Filters the alerts that contains connection events to the given countries. Use lowercased alpha-2 country codes, e.g., \\\"it\\\" for Italy. You can specify multiple country as comma separated values\"\n  }\n]"
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "05a5cba3-e24e-4ed2-a770-d2251eb443f8"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/ced236d0-c791-4490-b31a-5819c44b1c6b",
              "sourceStep": "/api/3/workflow_steps/d4f41797-e6be-4a61-9dac-41dcf14de645",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9ede2892-7365-40d0-a6ae-1011afe3dd16"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Record -> Fetch Associated Event",
              "targetStep": "/api/3/workflow_steps/a2aaf0f7-7598-415f-a135-9578949fdeed",
              "sourceStep": "/api/3/workflow_steps/eb9896ef-fda0-43d5-8197-f8bb0fa3a4e6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "38123a72-29e1-4965-8a06-7d727302c82e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Associated Event -> Set Result",
              "targetStep": "/api/3/workflow_steps/8d23b2ad-c2b8-4f5d-af6b-ca67af9b0ae2",
              "sourceStep": "/api/3/workflow_steps/a2aaf0f7-7598-415f-a135-9578949fdeed",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d3351832-50c1-4257-83b6-8547f406806a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Alert List For Mapping -> Mapping Data",
              "targetStep": "/api/3/workflow_steps/6d2e38e4-07cd-410f-aead-3f1c7abc5e2e",
              "sourceStep": "/api/3/workflow_steps/06d9984d-ce07-4fa0-98da-57e1b7fb079d",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "30c11369-406f-4fc9-a59e-bdb3be146725"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Alert List -> Record Current Time",
              "targetStep": "/api/3/workflow_steps/c23d650a-94c8-4611-8035-fffbf7e80391",
              "sourceStep": "/api/3/workflow_steps/3367cd30-da32-48cf-8d45-8379e4b34944",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "db51b34f-96e4-4267-b1b8-cb701cbcfd19"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Evaluate Time",
              "targetStep": "/api/3/workflow_steps/d6ed596e-7092-49b4-b5ab-742028cfa300",
              "sourceStep": "/api/3/workflow_steps/ced236d0-c791-4490-b31a-5819c44b1c6b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8a4b404c-be8b-44c7-af4b-8c7cb013fb63"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Data Only For Mapping -> Get Alert List",
              "targetStep": "/api/3/workflow_steps/3367cd30-da32-48cf-8d45-8379e4b34944",
              "sourceStep": "/api/3/workflow_steps/ff0e48f2-66fe-40aa-8695-d3bbf2eaa868",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "group": null,
              "uuid": "126fa6f4-de2d-42a7-833d-08f1c0a3a1b6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Data Only For Mapping -> Get Alert List",
              "targetStep": "/api/3/workflow_steps/06d9984d-ce07-4fa0-98da-57e1b7fb079d",
              "sourceStep": "/api/3/workflow_steps/ff0e48f2-66fe-40aa-8695-d3bbf2eaa868",
              "label": "Yes,For Mapping",
              "isExecuted": false,
              "group": null,
              "uuid": "4ca40647-160c-4e11-a77a-2905172ff198"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Record Current Time -> Create Record",
              "targetStep": "/api/3/workflow_steps/eb9896ef-fda0-43d5-8197-f8bb0fa3a4e6",
              "sourceStep": "/api/3/workflow_steps/c23d650a-94c8-4611-8035-fffbf7e80391",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d2579035-e72c-4419-9049-77a4582b1b11"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Is Data Only For Mapping",
              "targetStep": "/api/3/workflow_steps/ff0e48f2-66fe-40aa-8695-d3bbf2eaa868",
              "sourceStep": "/api/3/workflow_steps/d6ed596e-7092-49b4-b5ab-742028cfa300",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1497e23f-b349-41f4-bcd8-bcd5079faea2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/d4f41797-e6be-4a61-9dac-41dcf14de645",
              "sourceStep": "/api/3/workflow_steps/05a5cba3-e24e-4ed2-a770-d2251eb443f8",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8c349031-f574-47e8-9232-21f079ca4d25"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3a8e5245-a24d-44dd-a953-9a6c419e0491",
          "id": 878,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "fetch",
            "ibm-security-qradar-edr",
            "IBM"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> IBM QRadar EDR > Fetch Associated events for Alert",
          "aliasName": null,
          "tag": null,
          "description": "Fetch Associated events for alert.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "alert_data",
            "last_fetch_time"
          ],
          "synchronous": false,
          "lastModifyDate": 1691487127,
          "collection": "/api/3/workflow_collections/e8910062-8a5b-4937-a13f-479ed49cf72a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ca8316d1-fbcc-4d94-a699-52b67fe49c62",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Events for Alert",
              "description": null,
              "arguments": {
                "name": "IBM Security QRadar EDR",
                "config": "44c75a91-61fa-411e-926f-fb4666384a6b",
                "params": {
                  "gid": "",
                  "country": "",
                  "alert_id": "{{vars.input.params.alert_data.sourceId}}",
                  "severity": "",
                  "eventType": "",
                  "processId": "",
                  "processPid": "",
                  "happenedAfter": "{{vars.input.params['last_fetch_time']}}",
                  "happenedBefore": "",
                  "mitreTechnique": "",
                  "get_all_records": true
                },
                "version": "1.0.0",
                "connector": "ibm-security-qradar-edr",
                "operation": "get_events_related_to_alerts",
                "operationTitle": "Get Events Related To Alerts",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "c7ada409-5ea1-4049-964d-b4cbeb41fb74"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Result",
              "description": null,
              "arguments": {
                "alert_details": "{\"alert_data\":  {{vars.input.params.alert_data.sourcedata | toDict}}, \"associated_events\": {{vars.steps.Fetch_Events_for_Alert.data.result}} }"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "7718eaaa-179d-49e0-b826-9b364593ee75"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "ca8316d1-fbcc-4d94-a699-52b67fe49c62"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "resource": {
                  "sourcedata": "{{vars.alert_details | toJSON }}"
                },
                "operation": "Append",
                "collection": "{{vars.input.params.alert_data['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/alerts",
                "fieldOperation": [],
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "ae087f28-fa43-4e0f-aeb7-c0b08921f97a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Events for Alert -> Set Result",
              "targetStep": "/api/3/workflow_steps/7718eaaa-179d-49e0-b826-9b364593ee75",
              "sourceStep": "/api/3/workflow_steps/c7ada409-5ea1-4049-964d-b4cbeb41fb74",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7995bb49-78ee-4aea-b52a-9dd80f1fd6ba"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Result -> Update Record",
              "targetStep": "/api/3/workflow_steps/ae087f28-fa43-4e0f-aeb7-c0b08921f97a",
              "sourceStep": "/api/3/workflow_steps/7718eaaa-179d-49e0-b826-9b364593ee75",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "cd218d4c-e7df-43a8-8131-8e644dce1eeb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Events for Alert",
              "targetStep": "/api/3/workflow_steps/c7ada409-5ea1-4049-964d-b4cbeb41fb74",
              "sourceStep": "/api/3/workflow_steps/ca8316d1-fbcc-4d94-a699-52b67fe49c62",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "eacbec13-9b20-4a36-95be-324f6a89c2cc"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "75249f2a-a58c-41c9-99d0-448fdaa61d6b",
          "id": 879,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ibm-security-qradar-edr",
            "IBM"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Add Notes To Alert",
          "aliasName": null,
          "tag": "#IBM Security QRadar EDR",
          "description": "This action is used to add notes to an alert based on the alert ID provided",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/e8910062-8a5b-4937-a13f-479ed49cf72a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/80707173-1c63-4074-b6fa-fd977920618f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Add Notes To Alert",
              "description": null,
              "arguments": {
                "name": "IBM Security QRadar EDR",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "ibm-security-qradar-edr",
                "operation": "add_notes_to_alert",
                "operationTitle": "Add Notes To Alert",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7ff94d6e-133d-444d-966f-aa08e346e3d9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "954bfd2b-d325-4a91-b478-2639cc39226f",
                "title": "IBM Security QRadar EDR: Add Notes To Alert",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "80707173-1c63-4074-b6fa-fd977920618f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Add Notes To Alert",
              "targetStep": "/api/3/workflow_steps/7ff94d6e-133d-444d-966f-aa08e346e3d9",
              "sourceStep": "/api/3/workflow_steps/80707173-1c63-4074-b6fa-fd977920618f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "74e463b4-2aaf-46c7-9c82-9ed79fcef2e6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "a67583ed-4eb2-4d98-bbb2-b851b6358ccf",
          "id": 880,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "ibm-security-qradar-edr",
            "IBM"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Alert By ID",
          "aliasName": null,
          "tag": "#IBM Security QRadar EDR",
          "description": "This action is used to retrieve details of a particular alert.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/e8910062-8a5b-4937-a13f-479ed49cf72a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/73fc823d-511e-487b-8bd0-874aa0bde246",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Alert By ID",
              "description": null,
              "arguments": {
                "name": "IBM Security QRadar EDR",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "ibm-security-qradar-edr",
                "operation": "get_alert_by_id",
                "operationTitle": "Get Alert By ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e2bb30f1-8d91-4ef0-ae48-86ed1f1af318"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ed4ee5e1-74b4-4c2d-8bee-ca5c5d1bee1d",
                "title": "IBM Security QRadar EDR: Get Alert By ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "73fc823d-511e-487b-8bd0-874aa0bde246"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Alert By ID",
              "targetStep": "/api/3/workflow_steps/e2bb30f1-8d91-4ef0-ae48-86ed1f1af318",
              "sourceStep": "/api/3/workflow_steps/73fc823d-511e-487b-8bd0-874aa0bde246",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7f6af6ed-d73a-4ce5-8a2e-f70237beee3c"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "d1ff9534-80bc-4968-a4c9-2511dc98d0d4",
          "id": 881,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "ibm-security-qradar-edr",
            "IBM"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Alert List",
          "aliasName": null,
          "tag": "#IBM Security QRadar EDR",
          "description": "This action is used to retrieve all alerts generated in QRadar EDR",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691325758,
          "collection": "/api/3/workflow_collections/e8910062-8a5b-4937-a13f-479ed49cf72a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/75f2eaea-3c71-4cd6-8298-9850462099bf",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Alert List",
              "description": null,
              "arguments": {
                "name": "IBM Security QRadar EDR",
                "config": "44c75a91-61fa-411e-926f-fb4666384a6b",
                "params": {
                  "id": "56, 98789",
                  "gid": "",
                  "tag": "",
                  "count": "",
                  "status": "",
                  "country": "",
                  "severity": "",
                  "endpointId": "",
                  "lastSeenId": "",
                  "closedAfter": "",
                  "closedBefore": "",
                  "activityState": "",
                  "happenedAfter": "",
                  "receivedAfter": "",
                  "happenedBefore": "",
                  "receivedBefore": "",
                  "get_all_records": true,
                  "lastChangedAfter": "",
                  "triggerCondition": "",
                  "lastChangedBefore": ""
                },
                "version": "1.0.0",
                "connector": "ibm-security-qradar-edr",
                "operation": "get_alert_list",
                "operationTitle": "Get Alert List",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3afd77c5-f3cf-4370-8858-3b129dbdb9d8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "79f9e794-b49a-4e0a-a424-50f0b7fd4ff0",
                "title": "IBM Security QRadar EDR: Get Alert List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "75f2eaea-3c71-4cd6-8298-9850462099bf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Alert List",
              "targetStep": "/api/3/workflow_steps/3afd77c5-f3cf-4370-8858-3b129dbdb9d8",
              "sourceStep": "/api/3/workflow_steps/75f2eaea-3c71-4cd6-8298-9850462099bf",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "171901ff-3980-464a-bf8c-0516654142dc"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "eac674c0-0d9e-4354-9ab6-5feafff81978",
          "id": 882,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "ibm-security-qradar-edr",
            "IBM"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "IBM",
    "ibm-security-qradar-edr",
    "dataingestion",
    "ingest",
    "create",
    "fetch"
  ]
}